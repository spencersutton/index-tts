from pathlib import Path
from typing import Any, TypeVar

import numpy as np
from gradio.blocks import Block
from gradio.data_classes import JsonData
from PIL import Image

sync_transport = ...
async_transport = ...
sync_client = ...
log = ...

def to_binary(x: str | dict) -> bytes: ...
def extract_base64_data(x: str) -> str: ...
def encode_plot_to_base64(plt, format: str = ...):  # -> str:
    ...
def get_pil_exif_bytes(pil_image):  # -> None:
    ...
def get_pil_metadata(pil_image):  # -> PngInfo:
    ...
def encode_pil_to_bytes(pil_image, format=...):  # -> bytes:
    ...

hash_seed = ...

def hash_file(file_path: str | Path, chunk_num_blocks: int = ...) -> str: ...
def hash_url(url: str) -> str: ...
def hash_bytes(bytes: bytes):  # -> str:
    ...
def hash_base64(base64_encoding: str, chunk_num_blocks: int = ...) -> str: ...
def save_pil_to_cache(img: Image.Image, cache_dir: str, name: str = ..., format: str = ...) -> str: ...
def save_img_array_to_cache(arr: np.ndarray, cache_dir: str, format: str = ...) -> str: ...
def save_audio_to_cache(data: np.ndarray, sample_rate: int, format: str, cache_dir: str) -> str: ...
def detect_audio_format(data: bytes) -> str: ...
def save_bytes_to_cache(data: bytes, file_name: str, cache_dir: str) -> str: ...
def save_file_to_cache(file_path: str | Path, cache_dir: str) -> str: ...

PUBLIC_HOSTNAME_WHITELIST = ...

def is_public_ip(ip: str) -> bool: ...

T = TypeVar("T")

def lru_cache_async(maxsize: int = ...):  # -> Callable[..., Callable[..., Awaitable[T]]]:
    ...
async def async_ssrf_protected_download(url: str, cache_dir: str) -> str: ...
def unsafe_download(url: str, cache_dir: str) -> str: ...
def ssrf_protected_download(url: str, cache_dir: str) -> str: ...

save_url_to_cache = ...

def save_base64_to_cache(base64_encoding: str, cache_dir: str, file_name: str | None = ...) -> str: ...
def move_resource_to_block_cache(url_or_file_path: str | Path | None, block: Block) -> str | None: ...
def check_all_files_in_cache(data: JsonData):  # -> None:
    ...
def move_files_to_cache(
    data: Any, block: Block, postprocess: bool = ..., check_in_upload_folder=..., keep_in_cache=...
): ...
async def async_move_files_to_cache(
    data: Any, block: Block, postprocess: bool = ..., check_in_upload_folder=..., keep_in_cache=...
) -> dict: ...
def add_root_url(data: dict | list, root_url: str, previous_root_url: str | None): ...
def resize_and_crop(img, size, crop_type=...):  # -> Image:

    ...
def audio_from_file(filename: str, crop_min: float = ..., crop_max: float = ...) -> tuple[int, np.ndarray]: ...
def audio_to_file(sample_rate, data, filename, format=...):  # -> None:
    ...
def convert_to_16_bit_wav(data): ...
def ffmpeg_installed() -> bool: ...
def video_is_playable(video_filepath: str) -> bool: ...
def convert_video_to_playable_mp4(video_path: str) -> str: ...
def get_video_length(video_path: str | Path):  # -> float:
    ...
