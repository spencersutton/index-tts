from collections.abc import Callable
from typing import TYPE_CHECKING, Any, Self

import gradio as gr
from fastapi.responses import JSONResponse

from .utils import experimental, is_fastapi_available

"""Contains `WebhooksServer` and `webhook_endpoint` to create a webhook server easily."""
if TYPE_CHECKING: ...
if is_fastapi_available(): ...
else:
    JSONResponse = ...
_global_app: WebhooksServer | None = ...
_is_local = ...

@experimental
class WebhooksServer:
    def __new__(cls, *args, **kwargs) -> Self: ...
    def __init__(self, ui: gr.Blocks | None = ..., webhook_secret: str | None = ...) -> None: ...
    def add_webhook(self, path: str | None = ...) -> Callable: ...
    def launch(self, prevent_thread_lock: bool = ..., **launch_kwargs: Any) -> None: ...

@experimental
def webhook_endpoint(path: str | None = ...) -> Callable: ...
