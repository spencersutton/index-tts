from collections.abc import Callable, Iterator
from contextlib import contextmanager
from typing import ParamSpec, TypeVar, Union

import torch
import torch._ops
from torch._C import DispatchKey

__all__ = ["enable_python_dispatcher", "no_python_dispatcher", "enable_pre_dispatch"]
no_python_dispatcher = ...
enable_python_dispatcher = ...
enable_pre_dispatch = ...
CROSSREF_FUNCTIONALIZE = ...
_P = ParamSpec("_P")
_T = TypeVar("_T")

def all_py_loaded_overloads() -> Iterator[torch._ops.OpOverload]: ...
@contextmanager
def suspend_functionalization():  # -> Generator[None, Any, None]:
    ...
def check_tensor_metadata_matches(nv, rv, desc):  # -> None:
    ...
def check_metadata_matches(n, r, desc):  # -> None:
    ...

class Lit:
    def __init__(self, s) -> None: ...
    def __repr__(self):  # -> Any:
        ...

def make_crossref_functionalize[**P, T](
    op: torch._ops.OpOverload[_P, _T], final_key: DispatchKey
) -> Callable[_P, _T] | DispatchKey: ...
@contextmanager
def enable_crossref_functionalize():  # -> Generator[None, Any, None]:
    ...
