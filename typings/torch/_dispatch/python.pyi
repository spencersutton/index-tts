from collections.abc import Callable, Iterator
from contextlib import contextmanager
from typing import ParamSpec, TypeVar

import torch._ops
from torch._C import DispatchKey

__all__ = ["enable_pre_dispatch", "enable_python_dispatcher", "no_python_dispatcher"]
no_python_dispatcher = ...
enable_python_dispatcher = ...
enable_pre_dispatch = ...
CROSSREF_FUNCTIONALIZE = ...
_P = ParamSpec("_P")
_T = TypeVar("_T")

def all_py_loaded_overloads() -> Iterator[torch._ops.OpOverload]: ...
@contextmanager
def suspend_functionalization(): ...
def check_tensor_metadata_matches(nv, rv, desc): ...
def check_metadata_matches(n, r, desc): ...

class Lit:
    def __init__(self, s) -> None: ...

def make_crossref_functionalize[**P, T](
    op: torch._ops.OpOverload[_P, _T], final_key: DispatchKey
) -> Callable[_P, _T] | DispatchKey: ...
@contextmanager
def enable_crossref_functionalize(): ...
