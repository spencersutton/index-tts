from collections.abc import Callable, Sequence
from typing import Any, TextIO

import torch
from torch._dynamo.symbolic_convert import InstructionTranslatorBase
from torch._dynamo.variables.base import VariableTracker
from torch._subclasses.fake_tensor import FakeTensor

class ComptimeVar:
    def __init__(self, v: VariableTracker) -> None: ...
    def as_proxy(self) -> VariableTracker | Sequence[VariableTracker]: ...
    def is_proxy(self) -> bool: ...
    def as_fake(self) -> FakeTensor | torch.SymInt: ...
    def size(self, dim: int | None = ...) -> int | torch.SymInt: ...
    def python_type(self) -> type: ...
    def as_python_constant(self) -> Any: ...
    def is_python_constant(self) -> bool: ...
    def is_dynamic(self) -> bool: ...
    def force_static(self) -> None: ...

class ComptimeContext:
    def __init__(self, tx: InstructionTranslatorBase) -> None: ...
    def get_local(self, name: str, *, stacklevel: int = ...) -> ComptimeVar: ...
    def graph_break(self, msg: str = ...) -> None: ...
    def graph(self) -> torch.fx.Graph: ...
    def assert_static(self, val: ComptimeVar) -> None: ...
    def print_graph(self, *, verbose: bool = ..., file: TextIO | None = ...) -> None: ...
    def parent(self) -> ComptimeContext: ...
    def print(self, val: Any, *, file: TextIO | None = ...) -> None: ...
    def print_disas(self, *, file: TextIO | None = ..., stacklevel: int = ...) -> None: ...
    def print_value_stack(self, *, file: TextIO | None = ..., stacklevel: int = ...) -> None: ...
    def print_locals(self, *, file: TextIO | None = ..., stacklevel: int = ...) -> None: ...
    def print_bt(self, *, file: TextIO | None = ..., stacklevel: int = ...) -> None: ...
    def print_guards(self, *, file: TextIO | None = ...) -> None: ...
    def sleep(self, sec: float) -> None: ...

class _Comptime:
    @staticmethod
    def __call__(fn: Callable[[ComptimeContext], Any], fallback_fn: Callable[[], Any] = ...) -> Any: ...
    @staticmethod
    def graph_break() -> None: ...
    @staticmethod
    def print(e: Any) -> None: ...
    @staticmethod
    def print_graph() -> None: ...
    @staticmethod
    def print_disas(*, stacklevel: int = ...) -> None: ...
    @staticmethod
    def print_value_stack(*, stacklevel: int = ...) -> None: ...
    @staticmethod
    def print_value_stack_and_return(e: Any, *, stacklevel: int = ...) -> Any: ...
    @staticmethod
    def print_locals(*, stacklevel: int = ...) -> None: ...
    @staticmethod
    def print_bt(*, stacklevel: int = ...) -> None: ...
    @staticmethod
    def print_guards() -> None: ...
    @staticmethod
    def assert_static(val: Any) -> None: ...
    @staticmethod
    def force_static(val: Any) -> None: ...
    @staticmethod
    def breakpoint() -> None: ...
    @staticmethod
    def sleep(sec: float) -> None: ...

comptime = ...
