import torch
from torch._dynamo.symbolic_convert import InstructionTranslator

from .base import VariableTracker

class DistributedVariable(VariableTracker):
    def __init__(self, value, **kwargs) -> None: ...
    def python_type(self): ...
    @staticmethod
    def is_available(): ...

def is_from_local(value): ...
def is_constant_pg_functions(value): ...

class WorldMetaClassVariable(DistributedVariable):
    @classmethod
    def is_group_member_type(cls, value): ...
    def var_getattr(self, tx: InstructionTranslator, name: str) -> VariableTracker: ...

class PlacementClassVariable(DistributedVariable):
    @staticmethod
    def is_placement_type(value): ...
    def as_python_constant(self): ...
    def call_function(
        self, tx: InstructionTranslator, args: list[VariableTracker], kwargs: dict[str, VariableTracker]
    ) -> VariableTracker: ...

class PlacementVariable(DistributedVariable):
    @staticmethod
    def is_placement(value): ...
    def as_python_constant(self): ...
    def var_getattr(self, tx: InstructionTranslator, name: str) -> VariableTracker: ...
    def call_method(
        self, tx, name, args: list[VariableTracker], kwargs: dict[str, VariableTracker]
    ) -> VariableTracker: ...

class DeviceMeshVariable(DistributedVariable):
    @staticmethod
    def is_device_mesh(value): ...
    def as_python_constant(self): ...
    def var_getattr(self, tx: InstructionTranslator, name: str) -> VariableTracker: ...
    def call_method(
        self, tx, name, args: list[VariableTracker], kwargs: dict[str, VariableTracker]
    ) -> VariableTracker: ...

class ProcessGroupVariable(DistributedVariable):
    def as_python_constant(self): ...
    def call_method(
        self, tx, name, args: list[VariableTracker], kwargs: dict[str, VariableTracker]
    ) -> VariableTracker: ...
    def var_getattr(self, tx: InstructionTranslator, name): ...
    @staticmethod
    def is_process_group(value): ...

class BackwardHookVariable(VariableTracker):
    @staticmethod
    def create(tx, module: VariableTracker, user_hooks: VariableTracker, user_pre_hooks: VariableTracker): ...
    def __init__(
        self,
        proxy: torch.fx.Proxy,
        module: VariableTracker,
        user_hooks: VariableTracker,
        user_pre_hooks: VariableTracker,
        **options,
    ) -> None: ...
    def as_proxy(self): ...
    def call_method(
        self, tx, name, args: list[VariableTracker], kwargs: dict[str, VariableTracker]
    ) -> VariableTracker: ...
