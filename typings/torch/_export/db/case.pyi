from dataclasses import dataclass
from enum import Enum
from types import ModuleType
from typing import Any

import torch

_TAGS: dict[str, dict[str, Any]] = ...

class SupportLevel(Enum):
    """
    Indicates at what stage the feature
    used in the example is handled in export.
    """

    SUPPORTED = ...
    NOT_SUPPORTED_YET = ...

type ArgsType = tuple[Any, ...]

def check_inputs_type(args, kwargs): ...

@dataclass(frozen=True)
class ExportCase:
    """ExportCase(example_args: tuple[typing.Any, ...], description: str, model: torch.nn.modules.module.Module, name: str, example_kwargs: dict[str, typing.Any] = <factory>, extra_args: Optional[tuple[Any, ...]] = None, tags: set[str] = <factory>, support_level: torch._export.db.case.SupportLevel = <SupportLevel.SUPPORTED: 1>, dynamic_shapes: Optional[dict[str, Any]] = None)"""

    example_args: ArgsType
    description: str
    model: torch.nn.Module
    name: str
    example_kwargs: dict[str, Any] = ...
    extra_args: ArgsType | None = ...
    tags: set[str] = ...
    support_level: SupportLevel = ...
    dynamic_shapes: dict[str, Any] | None = ...
    def __post_init__(self): ...

_EXAMPLE_CASES: dict[str, ExportCase] = ...
_MODULES: set[ModuleType] = ...
_EXAMPLE_CONFLICT_CASES: dict[str, list[ExportCase]] = ...
_EXAMPLE_REWRITE_CASES: dict[str, list[ExportCase]] = ...

def register_db_case(case: ExportCase) -> None:
    """Registers a user provided ExportCase into example bank."""

def to_snake_case(name): ...
def export_case(**kwargs):
    """Decorator for registering a user provided case into example bank."""

def export_rewrite_case(**kwargs): ...
