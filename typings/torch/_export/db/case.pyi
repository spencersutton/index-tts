from dataclasses import dataclass
from enum import Enum
from types import ModuleType
from typing import Any, Optional, TypeAlias

import torch

_TAGS: dict[str, dict[str, Any]] = ...

class SupportLevel(Enum):
    SUPPORTED = ...
    NOT_SUPPORTED_YET = ...

type ArgsType = tuple[Any, ...]

def check_inputs_type(args, kwargs):  # -> None:
    ...

@dataclass(frozen=True)
class ExportCase:
    example_args: ArgsType
    description: str
    model: torch.nn.Module
    name: str
    example_kwargs: dict[str, Any] = ...
    extra_args: ArgsType | None = ...
    tags: set[str] = ...
    support_level: SupportLevel = ...
    dynamic_shapes: dict[str, Any] | None = ...
    def __post_init__(self):  # -> None:
        ...

_EXAMPLE_CASES: dict[str, ExportCase] = ...
_MODULES: set[ModuleType] = ...
_EXAMPLE_CONFLICT_CASES: dict[str, list[ExportCase]] = ...
_EXAMPLE_REWRITE_CASES: dict[str, list[ExportCase]] = ...

def register_db_case(case: ExportCase) -> None: ...
def to_snake_case(name):  # -> str:
    ...
def export_case(**kwargs):  # -> Callable[..., ExportCase]:

    ...
def export_rewrite_case(**kwargs):  # -> Callable[..., ExportCase]:
    ...
