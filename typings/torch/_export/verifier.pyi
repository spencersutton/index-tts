from typing import Any, final

from torch._ops import OpOverload
from torch.export.exported_program import ExportedProgram
from torch.fx import GraphModule

class SpecViolationError(Exception): ...

def is_functional(op: OpOverload) -> bool: ...

class _VerifierMeta(type):
    _registry: dict[str, type[Verifier]] = ...
    def __new__(metacls, name, bases, attrs): ...

def getattr_recursive(obj: Any, target: str) -> Any: ...

class Verifier(metaclass=_VerifierMeta):
    dialect = ...
    def allowed_builtin_ops(self) -> list: ...
    def allowed_op_types(self) -> tuple[type[Any], ...]: ...
    def allowed_getattr_types(self) -> tuple[type[Any], ...]: ...
    def allowed_getattr_types_for_subgm(self) -> tuple[type[Any], ...]: ...
    def check_valid_op(self, op): ...
    def check_additional(self, gm: GraphModule) -> None: ...
    @final
    def check(self, ep: ExportedProgram) -> None: ...

class TrainingIRVerifier(Verifier):
    dialect = ...

def load_verifier(dialect: str) -> type[Verifier]: ...
