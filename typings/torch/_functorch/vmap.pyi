import contextlib
from typing import TypeAlias, Union

type in_dims_t = int | tuple
type out_dims_t = int | tuple[int, ...]

def doesnt_support_saved_tensors_hooks(f):  # -> _Wrapped[..., Any, ..., Any]:
    ...
def vmap_impl(func, in_dims, out_dims, randomness, chunk_size, *args, **kwargs):  # -> PyTree | tuple[Any, ...]:
    ...
def get_chunk_sizes(total_elems, chunk_size): ...
@contextlib.contextmanager
def vmap_increment_nesting(batch_size, randomness):  # -> Generator[Any | int, Any, None]:
    ...
def restore_vmap(
    func, in_dims, batch_size, randomness
):  # -> Callable[..., tuple[Any, tuple[()]] | tuple[PyTree, PyTree]]:
    ...
def wrap_batched(args, bdims, level):  # -> tuple[Any, ...]:
    ...
def unwrap_batched(args, level):  # -> tuple[Any, tuple[()]] | tuple[PyTree, PyTree]:
    ...
