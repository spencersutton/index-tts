from ..utils import cache_on_self

log = ...

class MultiKernelState:
    def __init__(self) -> None: ...
    def define_kernel(self, kernels): ...

class MultiKernel:
    def __init__(self, kernels) -> None: ...
    @staticmethod
    def merge_workspaces_inplace(kernels): ...
    def call_kernel(self, kernel_name): ...
    def codegen_nan_check(self): ...
    @property
    def removed_buffers(self): ...
    @property
    def inplaced_to_remove(self): ...
    @property
    @cache_on_self
    def inplace_update_buffers(self): ...
    def warn_mix_layout(self, kernel_name: str): ...

class MultiKernelCall:
    def __init__(self, multi_kernel_name, kernels, arg_index, shape_specialize=...) -> None: ...
    def cache_file_path(self): ...
    def load_cache(self): ...
    def store_cache(self): ...
    @property
    def kernels(self): ...
    def benchmark_sub_kernels(self, *args, **kwargs): ...
    @staticmethod
    def record_choice(multi_kernel_name: str, picked_kernel_name: str): ...
    @staticmethod
    def lookup_choice(multi_kernel_name: str) -> str: ...
    def run(self, *args, **kwargs): ...
