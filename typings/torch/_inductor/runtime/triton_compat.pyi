from typing import Any, TypeAlias, Union

import triton
from triton import Config, knobs
from triton.backends.compiler import GPUTarget
from triton.compiler import CompiledKernel
from triton.compiler.compiler import ASTSource
from triton.language.extra import libdevice
from triton.language.standard import _log2
from triton.runtime.cache import triton_key
from triton.runtime.jit import KernelInterface

if triton is not None:
    libdevice = ...
    math = ...
    HAS_WARP_SPEC = ...
    builtins_use_semantic_kwarg = ...
    HAS_TRITON = ...
else:
    class OutOfResources(Exception): ...
    class PTXASError(Exception): ...

    Config = ...
    CompiledKernel = ...
    KernelInterface = ...
    ASTSource = ...
    GPUTarget = ...
    _log2 = ...
    libdevice = ...
    math = ...
    knobs = ...
    builtins_use_semantic_kwarg = ...
    class triton:
        @staticmethod
        def jit(*args: Any, **kwargs: Any) -> Any: ...

    class tl:
        @staticmethod
        def constexpr(val: Any) -> Any: ...

        type tensor = Any
        type dtype = Any

    HAS_WARP_SPEC = ...
    triton_key = ...
    HAS_TRITON = ...

def cc_warp_size(cc: str | int) -> int: ...

autograd_profiler = ...
__all__ = [
    "Config",
    "CompiledKernel",
    "OutOfResources",
    "KernelInterface",
    "PTXASError",
    "ASTSource",
    "GPUTarget",
    "tl",
    "_log2",
    "libdevice",
    "math",
    "triton",
    "cc_warp_size",
    "knobs",
    "triton_key",
]
