import contextlib
from collections.abc import Generator, Iterable
from typing import Any, Optional, Union
from collections.abc import Callable
from torch.utils._exposed_in import exposed_in

triton_ops_to_kernels: dict[str, list[object]] = ...

def get_triton_kernels_for_op(name: str) -> list[object]: ...
def get_inner_triton_kernels(fn: Callable[..., Any]) -> list[object]: ...
@exposed_in("torch.library")
def triton_op(
    name: str, fn: Callable | None = ..., /, *, mutates_args: str | Iterable[str], schema: str | None = ...
) -> Callable: ...

wrap_triton_enabled = ...
wrap_triton_enabled_default = ...

@contextlib.contextmanager
def set_wrap_triton_enabled(enabled: bool) -> Generator[None]: ...
def is_wrap_triton_enabled() -> bool: ...
def capture_triton(triton_kernel: Callable, /) -> Any: ...
@exposed_in("torch.library")
def wrap_triton(triton_kernel: Callable, /) -> Any: ...
