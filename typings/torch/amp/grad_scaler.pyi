"""
This type stub file was generated by pyright.
"""

import torch
from collections.abc import Iterable
from enum import Enum
from typing import Any, TYPE_CHECKING, overload

if TYPE_CHECKING: ...
__all__ = ["GradScaler", "OptState"]

class _MultiDeviceReplicator:
    def __init__(self, master_tensor: torch.Tensor) -> None: ...
    def get(self, device: torch.device) -> torch.Tensor: ...

class OptState(Enum):
    READY = ...
    UNSCALED = ...
    STEPPED = ...

class GradScaler:
    def __init__(
        self,
        device: str = ...,
        init_scale: float = ...,
        growth_factor: float = ...,
        backoff_factor: float = ...,
        growth_interval: int = ...,
        enabled: bool = ...,
    ) -> None: ...
    @overload
    def scale(self, outputs: torch.Tensor) -> torch.Tensor: ...
    @overload
    def scale(self, outputs: list[torch.Tensor]) -> list[torch.Tensor]: ...
    @overload
    def scale(self, outputs: tuple[torch.Tensor, ...]) -> tuple[torch.Tensor, ...]: ...
    @overload
    def scale(self, outputs: Iterable[torch.Tensor]) -> Iterable[torch.Tensor]: ...
    def scale(self, outputs: torch.Tensor | Iterable[torch.Tensor]) -> torch.Tensor | Iterable[torch.Tensor]: ...
    def unscale_(self, optimizer: torch.optim.Optimizer) -> None: ...
    def step(self, optimizer: torch.optim.Optimizer, *args: Any, **kwargs: Any) -> float | None: ...
    def update(self, new_scale: float | torch.Tensor | None = ...) -> None: ...
    def get_scale(self) -> float: ...
    def get_growth_factor(self) -> float: ...
    def set_growth_factor(self, new_factor: float) -> None: ...
    def get_backoff_factor(self) -> float: ...
    def set_backoff_factor(self, new_factor: float) -> None: ...
    def get_growth_interval(self) -> int: ...
    def set_growth_interval(self, new_interval: int) -> None: ...
    def is_enabled(self) -> bool: ...
    def state_dict(self) -> dict[str, Any]: ...
    def load_state_dict(self, state_dict: dict[str, Any]) -> None: ...
    def __getstate__(self) -> dict[str, Any]: ...
    def __setstate__(self, state: dict[str, Any]) -> None: ...
