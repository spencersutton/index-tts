import abc
from typing import Any

from torch import nn

__all__ = ["BaseSparsifier"]
SUPPORTED_MODULES = ...
KEYS_NOT_IN_STATE_DICT = ...

class BaseSparsifier(abc.ABC):
    def __init__(self, defaults: dict[str, Any] | None = ...) -> None: ...
    def __getstate__(self) -> dict[str, Any]: ...
    def __setstate__(self, state: dict[str, dict[str, Any]]) -> None: ...
    def state_dict(self) -> dict[str, Any]: ...
    def load_state_dict(self, state_dict: dict[str, Any], strict: bool = ...) -> None: ...
    def make_config_from_model(self, model: nn.Module, SUPPORTED_MODULES: set[type[nn.Linear]] = ...) -> None: ...
    def prepare(self, model, config) -> None: ...
    def squash_mask(
        self,
        params_to_keep: tuple[str, ...] | None = ...,
        params_to_keep_per_layer: dict[str, tuple[str, ...]] | None = ...,
        *args,
        **kwargs,
    ) -> None: ...
    def convert(
        self,
        module: nn.Module,
        mapping: dict[type[nn.Module], type[nn.Module]] | None = ...,
        inplace: bool = ...,
        parameterization: type[nn.Module] = ...,
    ) -> Module: ...
    def step(self, use_path: bool = ...) -> None: ...
    @abc.abstractmethod
    def update_mask(self, module: nn.Module, tensor_name: str, **kwargs) -> None: ...
