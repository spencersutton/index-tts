from abc import ABC
from collections.abc import Callable

import torch
from torch.ao.quantization.utils import NodePattern

__all__ = [
    "BatchNormQuantizeHandler",
    "BinaryOpQuantizeHandler",
    "CatQuantizeHandler",
    "ConvReluQuantizeHandler",
    "CopyNodeQuantizeHandler",
    "CustomModuleQuantizeHandler",
    "DefaultNodeQuantizeHandler",
    "EmbeddingQuantizeHandler",
    "FixedQParamsOpQuantizeHandler",
    "GeneralTensorShapeOpQuantizeHandler",
    "LinearReLUQuantizeHandler",
    "QuantizeHandler",
    "RNNDynamicQuantizeHandler",
    "StandaloneModuleQuantizeHandler",
]

class QuantizeHandler(ABC):
    def __init__(
        self,
        node_pattern: NodePattern,
        modules: dict[str, torch.nn.Module],
        root_node_getter: Callable | None = ...,
        is_custom_module=...,
        is_standalone_module=...,
    ) -> None: ...
    def is_general_tensor_value_op(self) -> bool: ...
    def is_custom_module(self) -> bool: ...
    def is_standalone_module(self) -> bool: ...

class BinaryOpQuantizeHandler(QuantizeHandler): ...
class CatQuantizeHandler(QuantizeHandler): ...
class ConvReluQuantizeHandler(QuantizeHandler): ...
class LinearReLUQuantizeHandler(QuantizeHandler): ...
class BatchNormQuantizeHandler(QuantizeHandler): ...
class EmbeddingQuantizeHandler(QuantizeHandler): ...
class RNNDynamicQuantizeHandler(QuantizeHandler): ...
class DefaultNodeQuantizeHandler(QuantizeHandler): ...
class FixedQParamsOpQuantizeHandler(QuantizeHandler): ...
class CopyNodeQuantizeHandler(QuantizeHandler): ...
class GeneralTensorShapeOpQuantizeHandler(QuantizeHandler): ...
class CustomModuleQuantizeHandler(QuantizeHandler): ...
class StandaloneModuleQuantizeHandler(QuantizeHandler): ...
