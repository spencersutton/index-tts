from contextlib import contextmanager
from typing import TYPE_CHECKING

from torch.backends import ContextProp, PropModule

def is_available() -> bool: ...

VERBOSE_OFF = ...
VERBOSE_ON = ...
VERBOSE_ON_CREATION = ...

class verbose:
    def __init__(self, level) -> None: ...
    def __enter__(self) -> Self | None: ...
    def __exit__(self, exc_type, exc_val, exc_tb) -> Literal[False]: ...

def set_flags(
    _enabled=..., _deterministic=..., _allow_tf32=..., _fp32_precision=...
) -> tuple[bool, bool, bool, str]: ...
@contextmanager
def flags(enabled=..., deterministic=..., allow_tf32=..., fp32_precision=...) -> Generator[None, Any, None]: ...

class MkldnnModule(PropModule):
    def __init__(self, m, name) -> None: ...
    def is_available(self) -> bool: ...

    enabled = ...
    deterministic = ...
    allow_tf32 = ...
    matmul = ...
    conv = ...
    rnn = ...
    fp32_precision = ...

if TYPE_CHECKING:
    enabled: ContextProp
    deterministic: ContextProp
    allow_tf32: ContextProp
    ...
