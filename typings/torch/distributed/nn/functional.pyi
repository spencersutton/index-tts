from torch.autograd import Function

def broadcast(tensor, src, group=...) -> Any | None: ...
def gather(tensor, dst=..., group=...) -> Any | None: ...
def scatter(tensors, src=..., group=...) -> Any | None: ...
def reduce(tensor, dst, op=..., group=...) -> Any | None: ...
def reduce_scatter(output, input_list, op=..., group=...) -> Any | None: ...
def all_gather(tensor, group=...) -> Any | None: ...
def all_to_all(output_tensor_list, input_tensor_list, group=...) -> Any | None: ...
def all_to_all_single(output, input, output_split_sizes=..., input_split_sizes=..., group=...) -> Any | None: ...
def all_reduce(tensor, op=..., group=...) -> Any | None: ...

class _Broadcast(Function):
    @staticmethod
    def forward(ctx, src, group, tensor): ...
    @staticmethod
    def backward(ctx, grad_output) -> tuple[None, None, Any | None]: ...

class _Gather(Function):
    @staticmethod
    def forward(ctx, dst, group, tensor) -> tuple[Tensor, ...]: ...
    @staticmethod
    def backward(ctx, *grad_outputs) -> tuple[None, None, Any | None]: ...

class _Scatter(Function):
    @staticmethod
    def forward(ctx, src, group, *tensors) -> Tensor: ...
    @staticmethod
    def backward(ctx, grad_output) -> Any: ...

class _Reduce(Function):
    @staticmethod
    def forward(ctx, src, op, group, tensor): ...
    @staticmethod
    def backward(ctx, grad_output) -> tuple[None, None, None, Any | None]: ...

class _Reduce_Scatter(Function):
    @staticmethod
    def forward(ctx, op, group, tensor, *input_tensor_list): ...
    @staticmethod
    def backward(ctx, grad_output) -> Any: ...

class _AllGather(Function):
    @staticmethod
    def forward(ctx, group, tensor) -> tuple[Tensor, ...]: ...
    @staticmethod
    def backward(ctx, *grad_outputs) -> tuple[None, Any | Tensor | None]: ...

class _AllGatherBase(Function):
    @staticmethod
    def forward(ctx, output_tensor, input_tensor, group): ...
    @staticmethod
    def backward(ctx, grad_output) -> tuple[None, Tensor, None]: ...

class _AlltoAll(Function):
    @staticmethod
    def forward(ctx, group, out_tensor_list, *tensors) -> tuple[Any, ...]: ...
    @staticmethod
    def backward(ctx, *grad_outputs) -> Any: ...

class _AlltoAllSingle(Function):
    @staticmethod
    def forward(ctx, group, output, output_split_sizes, input_split_sizes, input): ...
    @staticmethod
    def backward(ctx, grad_output) -> tuple[None, None, None, None, Any | None]: ...

class _AllReduce(Function):
    @staticmethod
    def forward(ctx, op, group, tensor): ...
    @staticmethod
    def backward(ctx, grad_output) -> tuple[None, None, Any | None]: ...
