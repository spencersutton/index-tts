import torch
from typing import Optional
from torch.distributed.device_mesh import DeviceMesh

logger = ...
__all__ = ["is_rng_supported_mesh", "manual_seed", "OffsetBasedRNGTracker"]
_rng_tracker: Optional[_RNGStateTracker] = ...

def is_rng_supported_mesh(device_mesh: DeviceMesh) -> bool: ...
def manual_seed(seed: int, device_mesh: DeviceMesh) -> None: ...

class _PhiloxState:
    def __init__(self, state: torch.Tensor) -> None: ...
    @property
    def state(self):  # -> Tensor:
        ...
    @property
    def offset(self) -> int: ...
    @offset.setter
    def offset(self, offset: int) -> None: ...
    @property
    def seed(self) -> int: ...
    @seed.setter
    def seed(self, seed: int) -> None: ...

class _RNGStateTracker:
    def __init__(self, device: torch.device) -> None: ...
    @property
    def distribute_region_enabled(self) -> bool: ...
    @distribute_region_enabled.setter
    def distribute_region_enabled(self, value) -> None: ...

class OffsetBasedRNGTracker(_RNGStateTracker):
    def __init__(self, device_mesh: DeviceMesh, run_state_sync: bool = ...) -> None: ...
