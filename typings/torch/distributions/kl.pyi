from collections.abc import Callable
from functools import total_ordering
from torch import Tensor
from .distribution import Distribution

_KL_REGISTRY: dict[tuple[type, type], Callable] = ...
_KL_MEMOIZE: dict[tuple[type, type], Callable] = ...
__all__ = ["kl_divergence", "register_kl"]

def register_kl(type_p, type_q) -> Callable[..., Any]: ...

@total_ordering
class _Match:
    __slots__ = ...
    def __init__(self, *types) -> None: ...
    def __eq__(self, other) -> bool: ...
    def __le__(self, other) -> bool: ...

def kl_divergence(p: Distribution, q: Distribution) -> Tensor: ...
