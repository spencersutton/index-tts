from typing import Any, Self

__all__ = ["BackwardHook", "RemovableHandle", "unserializable_hook", "warn_if_has_hooks"]

class RemovableHandle:
    id: int
    next_id: int = ...
    def __init__(self, hooks_dict: Any, *, extra_dict: Any = ...) -> None: ...
    def remove(self) -> None: ...
    def __getstate__(
        self,
    ) -> (
        tuple[OrderedDict[Any, Any] | Any | None, int] | tuple[OrderedDict[Any, Any] | Any | None, int, tuple[Any, ...]]
    ): ...
    def __setstate__(self, state) -> None: ...
    def __enter__(self) -> Self: ...
    def __exit__(self, type: Any, value: Any, tb: Any) -> None: ...

def unserializable_hook(f): ...
def warn_if_has_hooks(tensor) -> None: ...

class BackwardHook:
    def __init__(self, module, user_hooks, user_pre_hooks) -> None: ...
    def setup_input_hook(self, args) -> tuple[Any, ...] | Any: ...
    def setup_output_hook(self, args) -> Any | tuple[Any, ...]: ...
