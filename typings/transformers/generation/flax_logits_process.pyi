import jax.numpy as jnp
from ..utils import add_start_docstrings

logger = ...
LOGITS_PROCESSOR_INPUTS_DOCSTRING = ...

class FlaxLogitsProcessor:
    @add_start_docstrings(LOGITS_PROCESSOR_INPUTS_DOCSTRING)
    def __call__(self, input_ids: jnp.ndarray, scores: jnp.ndarray) -> jnp.ndarray: ...

class FlaxLogitsWarper:
    @add_start_docstrings(LOGITS_PROCESSOR_INPUTS_DOCSTRING)
    def __call__(self, input_ids: jnp.ndarray, scores: jnp.ndarray) -> jnp.ndarray: ...

class FlaxLogitsProcessorList(list):
    @add_start_docstrings(LOGITS_PROCESSOR_INPUTS_DOCSTRING)
    def __call__(self, input_ids: jnp.ndarray, scores: jnp.ndarray, cur_len: int, **kwargs) -> jnp.ndarray: ...

class FlaxTemperatureLogitsWarper(FlaxLogitsWarper):
    def __init__(self, temperature: float) -> None: ...
    def __call__(self, input_ids: jnp.ndarray, scores: jnp.ndarray, cur_len: int) -> jnp.ndarray: ...

class FlaxTopPLogitsWarper(FlaxLogitsWarper):
    def __init__(self, top_p: float, filter_value: float = ..., min_tokens_to_keep: int = ...) -> None: ...
    def __call__(self, input_ids: jnp.ndarray, scores: jnp.ndarray, cur_len: int) -> jnp.ndarray: ...

class FlaxTopKLogitsWarper(FlaxLogitsWarper):
    def __init__(self, top_k: int, filter_value: float = ..., min_tokens_to_keep: int = ...) -> None: ...
    def __call__(self, input_ids: jnp.ndarray, scores: jnp.ndarray, cur_len: int) -> jnp.ndarray: ...

class FlaxForcedBOSTokenLogitsProcessor(FlaxLogitsProcessor):
    def __init__(self, bos_token_id: int) -> None: ...
    def __call__(self, input_ids: jnp.ndarray, scores: jnp.ndarray, cur_len: int) -> jnp.ndarray: ...

class FlaxForcedEOSTokenLogitsProcessor(FlaxLogitsProcessor):
    def __init__(self, max_length: int, eos_token_id: int) -> None: ...
    def __call__(self, input_ids: jnp.ndarray, scores: jnp.ndarray, cur_len: int) -> jnp.ndarray: ...

class FlaxMinLengthLogitsProcessor(FlaxLogitsProcessor):
    def __init__(self, min_length: int, eos_token_id: int) -> None: ...
    def __call__(self, input_ids: jnp.ndarray, scores: jnp.ndarray, cur_len: int) -> jnp.ndarray: ...

class FlaxSuppressTokensAtBeginLogitsProcessor(FlaxLogitsProcessor):
    def __init__(self, begin_suppress_tokens, begin_index) -> None: ...
    def __call__(self, input_ids, scores, cur_len: int): ...

class FlaxSuppressTokensLogitsProcessor(FlaxLogitsProcessor):
    def __init__(self, suppress_tokens: list) -> None: ...
    def __call__(self, input_ids: jnp.ndarray, scores: jnp.ndarray, cur_len: int) -> jnp.ndarray: ...

class FlaxForceTokensLogitsProcessor(FlaxLogitsProcessor):
    def __init__(self, force_token_map) -> None: ...
    def __call__(self, input_ids: jnp.ndarray, scores: jnp.ndarray, cur_len: int) -> jnp.ndarray: ...

class FlaxWhisperTimeStampLogitsProcessor(FlaxLogitsProcessor):
    def __init__(self, generate_config, model_config, decoder_input_length) -> None: ...
    def __call__(self, input_ids, scores, cur_len): ...

class FlaxNoRepeatNGramLogitsProcessor(FlaxLogitsProcessor):
    def __init__(self, ngram_size: int) -> None: ...
    def get_previous_ngrams(self, input_ids: jnp.ndarray, vocab_size: int, cur_len: int): ...
    def get_banned_tokens_mask(self, latest_tokens: jnp.ndarray, previous_ngrams) -> jnp.ndarray: ...
    def __call__(self, input_ids: jnp.ndarray, scores: jnp.ndarray, cur_len: int) -> jnp.ndarray: ...
