"""
This type stub file was generated by pyright.
"""

from ..utils.import_utils import is_torch_npu_available

if is_torch_npu_available(): ...
TOP_LEFT_ALIGNED_CAUSAL_MASK_MODE = ...
DOWN_RIGHT_ALIGNED_CAUSAL_MASK_MODE = ...
SPARSE_MODE = ...
if SPARSE_MODE not in [TOP_LEFT_ALIGNED_CAUSAL_MASK_MODE, DOWN_RIGHT_ALIGNED_CAUSAL_MASK_MODE]: ...
ATTN_MASK_NPU_CACHE = ...

def get_attn_mask_npu(device):
    """Get or create attention mask for the specified device."""
    ...

def is_npu_fa2_top_left_aligned_causal_mask():  # -> bool:
    ...
def npu_flash_attn_func(q, k, v, dropout_p=..., softmax_scale=..., causal=..., **kwargs): ...
def npu_flash_attn_varlen_func(
    q,
    k,
    v,
    cu_seqlens_q,
    cu_seqlens_k,
    max_seqlen_q=...,
    max_seqlen_k=...,
    dropout_p=...,
    softmax_scale=...,
    causal=...,
    **kwargs,
): ...
