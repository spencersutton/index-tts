"""
This type stub file was generated by pyright.
"""

import torch
from typing import Optional, TypedDict

logger = ...

def flash_attn_supports_top_left_mask(): ...
def is_flash_attn_available(): ...

_flash_fn = ...
_flash_varlen_fn = ...
_pad_fn = ...
_unpad_fn = ...
_process_flash_kwargs_fn = ...
_hf_api_to_flash_mapping = ...

def lazy_import_flash_attention(implementation: Optional[str]): ...
def prepare_fa_kwargs_from_position_ids(position_ids, is_packed_sequence: bool = ...): ...
def fa_peft_integration_check(
    q: torch.Tensor, k: torch.Tensor, v: torch.Tensor, target_dtype: Optional[torch.dtype] = ...
): ...

class FlashAttentionKwargs(TypedDict, total=False):
    cumulative_seqlens_q: Optional[torch.LongTensor]
    cumulative_seqlens_k: Optional[torch.LongTensor]
    max_length_q: Optional[int]
    max_length_k: Optional[int]
    ...
