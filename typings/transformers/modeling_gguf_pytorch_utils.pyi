from typing import NamedTuple

import numpy as np

from .utils import is_torch_available

if is_torch_available(): ...
logger = ...
GGUF_TO_TRANSFORMERS_MAPPING = ...
GGUF_SUPPORTED_ARCHITECTURES = ...

class GGUFTensor(NamedTuple):
    weights: np.ndarray
    name: str
    metadata: dict

class TensorProcessor:
    def __init__(self, config=...) -> None: ...
    def process(self, weights, name, **kwargs):  # -> GGUFTensor:
        ...

class LlamaTensorProcessor(TensorProcessor):
    def __init__(self, config=...) -> None: ...
    def process(self, weights, name, **kwargs):  # -> GGUFTensor:
        ...

class Qwen2MoeTensorProcessor(TensorProcessor):
    def __init__(self, config=...) -> None: ...
    def process(self, weights, name, **kwargs):  # -> GGUFTensor:
        ...

class BloomTensorProcessor(TensorProcessor):
    def __init__(self, config=...) -> None: ...
    def process(self, weights, name, **kwargs):  # -> GGUFTensor:
        ...

class T5TensorProcessor(TensorProcessor):
    def __init__(self, config=...) -> None: ...
    def process(self, weights, name, **kwargs):  # -> GGUFTensor:
        ...

class GPT2TensorProcessor(TensorProcessor):
    def __init__(self, config=...) -> None: ...
    def process(self, weights, name, **kwargs):  # -> GGUFTensor:
        ...

class MambaTensorProcessor(TensorProcessor):
    def __init__(self, config=...) -> None: ...
    def process(self, weights, name, **kwargs):  # -> GGUFTensor:
        ...

class NemotronTensorProcessor(TensorProcessor):
    def __init__(self, config=...) -> None: ...
    def process(self, weights, name, **kwargs):  # -> GGUFTensor:
        ...

class Gemma2TensorProcessor(TensorProcessor):
    def __init__(self, config=...) -> None: ...
    def process(self, weights, name, **kwargs):  # -> GGUFTensor:
        ...

TENSOR_PROCESSORS = ...

def read_field(reader, field):  # -> list[Any]:
    ...
def get_gguf_hf_weights_map(
    hf_model, model_type: str | None = ..., num_layers: int | None = ..., qual_name: str = ...
):  # -> dict[Any, Any]:

    ...
def load_gguf_checkpoint(gguf_checkpoint_path, return_tensors=..., model_to_load=...): ...
