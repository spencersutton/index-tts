from dataclasses import dataclass

import torch

from .cache_utils import Cache, EncoderDecoderCache
from .utils import ModelOutput

@dataclass
class BaseModelOutput(ModelOutput):
    last_hidden_state: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class BaseModelOutputWithNoAttention(ModelOutput):
    last_hidden_state: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...

@dataclass
class BaseModelOutputWithPooling(ModelOutput):
    last_hidden_state: torch.Tensor | None = ...
    pooler_output: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class BaseModelOutputWithPoolingAndNoAttention(ModelOutput):
    last_hidden_state: torch.Tensor | None = ...
    pooler_output: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...

@dataclass
class BaseModelOutputWithPast(ModelOutput):
    last_hidden_state: torch.Tensor | None = ...
    past_key_values: Cache | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class BaseModelOutputWithCrossAttentions(ModelOutput):
    last_hidden_state: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...
    cross_attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class BaseModelOutputWithPoolingAndCrossAttentions(ModelOutput):
    last_hidden_state: torch.Tensor | None = ...
    pooler_output: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    past_key_values: Cache | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...
    cross_attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class BaseModelOutputWithPastAndCrossAttentions(ModelOutput):
    last_hidden_state: torch.Tensor | None = ...
    past_key_values: Cache | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...
    cross_attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class MoECausalLMOutputWithPast(ModelOutput):
    loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    past_key_values: Cache | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...
    z_loss: torch.Tensor | None = ...
    aux_loss: torch.Tensor | None = ...
    router_logits: tuple[torch.Tensor] | None = ...

@dataclass
class MoEModelOutput(ModelOutput):
    last_hidden_state: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...
    router_probs: tuple[torch.Tensor] | None = ...

@dataclass
class MoeModelOutputWithPast(ModelOutput):
    last_hidden_state: torch.Tensor | None = ...
    past_key_values: Cache | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...
    router_logits: tuple[torch.Tensor] | None = ...

@dataclass
class MoeCausalLMOutputWithPast(ModelOutput):
    loss: torch.Tensor | None = ...
    aux_loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    past_key_values: Cache | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...
    router_logits: tuple[torch.Tensor] | None = ...

@dataclass
class MoEModelOutputWithPastAndCrossAttentions(ModelOutput):
    last_hidden_state: torch.Tensor | None = ...
    past_key_values: Cache | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...
    cross_attentions: tuple[torch.Tensor, ...] | None = ...
    router_probs: tuple[torch.Tensor] | None = ...

@dataclass
class Seq2SeqModelOutput(ModelOutput):
    last_hidden_state: torch.Tensor | None = ...
    past_key_values: EncoderDecoderCache | None = ...
    decoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    decoder_attentions: tuple[torch.Tensor, ...] | None = ...
    cross_attentions: tuple[torch.Tensor, ...] | None = ...
    encoder_last_hidden_state: torch.Tensor | None = ...
    encoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    encoder_attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class Seq2SeqMoEModelOutput(ModelOutput):
    last_hidden_state: torch.Tensor | None = ...
    past_key_values: EncoderDecoderCache | None = ...
    decoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    decoder_attentions: tuple[torch.Tensor, ...] | None = ...
    decoder_router_logits: tuple[torch.Tensor] | None = ...
    cross_attentions: tuple[torch.Tensor, ...] | None = ...
    encoder_last_hidden_state: torch.Tensor | None = ...
    encoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    encoder_attentions: tuple[torch.Tensor, ...] | None = ...
    encoder_router_logits: tuple[torch.Tensor] | None = ...

@dataclass
class CausalLMOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class CausalLMOutputWithPast(ModelOutput):
    loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    past_key_values: Cache | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class CausalLMOutputWithCrossAttentions(ModelOutput):
    loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    past_key_values: Cache | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...
    cross_attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class SequenceClassifierOutputWithPast(ModelOutput):
    loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    past_key_values: Cache | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class MaskedLMOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class Seq2SeqLMOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    past_key_values: EncoderDecoderCache | None = ...
    decoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    decoder_attentions: tuple[torch.Tensor, ...] | None = ...
    cross_attentions: tuple[torch.Tensor, ...] | None = ...
    encoder_last_hidden_state: torch.Tensor | None = ...
    encoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    encoder_attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class Seq2SeqMoEOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    encoder_z_loss: torch.Tensor | None = ...
    decoder_z_loss: torch.Tensor | None = ...
    encoder_aux_loss: torch.Tensor | None = ...
    decoder_aux_loss: torch.Tensor | None = ...
    past_key_values: EncoderDecoderCache | None = ...
    decoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    decoder_attentions: tuple[torch.Tensor, ...] | None = ...
    decoder_router_logits: tuple[torch.Tensor] | None = ...
    cross_attentions: tuple[torch.Tensor, ...] | None = ...
    encoder_last_hidden_state: torch.Tensor | None = ...
    encoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    encoder_attentions: tuple[torch.Tensor, ...] | None = ...
    encoder_router_logits: tuple[torch.Tensor] | None = ...

@dataclass
class NextSentencePredictorOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class SequenceClassifierOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class Seq2SeqSequenceClassifierOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    past_key_values: EncoderDecoderCache | None = ...
    decoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    decoder_attentions: tuple[torch.Tensor, ...] | None = ...
    cross_attentions: tuple[torch.Tensor, ...] | None = ...
    encoder_last_hidden_state: torch.Tensor | None = ...
    encoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    encoder_attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class MultipleChoiceModelOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class TokenClassifierOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class QuestionAnsweringModelOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    start_logits: torch.Tensor | None = ...
    end_logits: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class Seq2SeqQuestionAnsweringModelOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    start_logits: torch.Tensor | None = ...
    end_logits: torch.Tensor | None = ...
    past_key_values: EncoderDecoderCache | None = ...
    decoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    decoder_attentions: tuple[torch.Tensor, ...] | None = ...
    cross_attentions: tuple[torch.Tensor, ...] | None = ...
    encoder_last_hidden_state: torch.Tensor | None = ...
    encoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    encoder_attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class SemanticSegmenterOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class ImageClassifierOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class ImageClassifierOutputWithNoAttention(ModelOutput):
    loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...

@dataclass
class DepthEstimatorOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    predicted_depth: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class ImageSuperResolutionOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    reconstruction: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class Wav2Vec2BaseModelOutput(ModelOutput):
    last_hidden_state: torch.Tensor | None = ...
    extract_features: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class XVectorOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    logits: torch.Tensor | None = ...
    embeddings: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class BackboneOutput(ModelOutput):
    feature_maps: tuple[torch.Tensor] | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class BaseModelOutputWithPoolingAndProjection(ModelOutput):
    last_hidden_state: torch.Tensor | None = ...
    pooler_output: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...
    projection_state: tuple[torch.Tensor] | None = ...

@dataclass
class Seq2SeqSpectrogramOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    spectrogram: torch.Tensor | None = ...
    past_key_values: EncoderDecoderCache | None = ...
    decoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    decoder_attentions: tuple[torch.Tensor, ...] | None = ...
    cross_attentions: tuple[torch.Tensor, ...] | None = ...
    encoder_last_hidden_state: torch.Tensor | None = ...
    encoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    encoder_attentions: tuple[torch.Tensor, ...] | None = ...

@dataclass
class Seq2SeqTSModelOutput(ModelOutput):
    last_hidden_state: torch.Tensor | None = ...
    past_key_values: EncoderDecoderCache | None = ...
    decoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    decoder_attentions: tuple[torch.Tensor, ...] | None = ...
    cross_attentions: tuple[torch.Tensor, ...] | None = ...
    encoder_last_hidden_state: torch.Tensor | None = ...
    encoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    encoder_attentions: tuple[torch.Tensor, ...] | None = ...
    loc: torch.Tensor | None = ...
    scale: torch.Tensor | None = ...
    static_features: torch.Tensor | None = ...

@dataclass
class Seq2SeqTSPredictionOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    params: tuple[torch.Tensor] | None = ...
    past_key_values: EncoderDecoderCache | None = ...
    decoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    decoder_attentions: tuple[torch.Tensor, ...] | None = ...
    cross_attentions: tuple[torch.Tensor, ...] | None = ...
    encoder_last_hidden_state: torch.Tensor | None = ...
    encoder_hidden_states: tuple[torch.Tensor, ...] | None = ...
    encoder_attentions: tuple[torch.Tensor, ...] | None = ...
    loc: torch.Tensor | None = ...
    scale: torch.Tensor | None = ...
    static_features: torch.Tensor | None = ...

@dataclass
class SampleTSPredictionOutput(ModelOutput):
    sequences: torch.Tensor | None = ...

@dataclass
class MaskedImageModelingOutput(ModelOutput):
    loss: torch.Tensor | None = ...
    reconstruction: torch.Tensor | None = ...
    hidden_states: tuple[torch.Tensor, ...] | None = ...
    attentions: tuple[torch.Tensor, ...] | None = ...
    @property
    def logits(self):  # -> Tensor | None:
        ...
