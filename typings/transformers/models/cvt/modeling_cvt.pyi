"""
This type stub file was generated by pyright.
"""

import torch
from dataclasses import dataclass
from typing import Optional, Union
from torch import nn
from ...modeling_outputs import ImageClassifierOutputWithNoAttention, ModelOutput
from ...modeling_utils import PreTrainedModel
from ...utils import auto_docstring
from .configuration_cvt import CvtConfig

logger = ...

@dataclass
@auto_docstring(custom_intro=...)
class BaseModelOutputWithCLSToken(ModelOutput):
    last_hidden_state: Optional[torch.FloatTensor] = ...
    cls_token_value: Optional[torch.FloatTensor] = ...
    hidden_states: Optional[tuple[torch.FloatTensor, ...]] = ...

def drop_path(input: torch.Tensor, drop_prob: float = ..., training: bool = ...) -> torch.Tensor: ...

class CvtDropPath(nn.Module):
    def __init__(self, drop_prob: Optional[float] = ...) -> None: ...
    def forward(self, hidden_states: torch.Tensor) -> torch.Tensor: ...
    def extra_repr(self) -> str: ...

class CvtEmbeddings(nn.Module):
    def __init__(self, patch_size, num_channels, embed_dim, stride, padding, dropout_rate) -> None: ...
    def forward(self, pixel_values): ...

class CvtConvEmbeddings(nn.Module):
    def __init__(self, patch_size, num_channels, embed_dim, stride, padding) -> None: ...
    def forward(self, pixel_values): ...

class CvtSelfAttentionConvProjection(nn.Module):
    def __init__(self, embed_dim, kernel_size, padding, stride) -> None: ...
    def forward(self, hidden_state): ...

class CvtSelfAttentionLinearProjection(nn.Module):
    def forward(self, hidden_state): ...

class CvtSelfAttentionProjection(nn.Module):
    def __init__(self, embed_dim, kernel_size, padding, stride, projection_method=...) -> None: ...
    def forward(self, hidden_state): ...

class CvtSelfAttention(nn.Module):
    def __init__(
        self,
        num_heads,
        embed_dim,
        kernel_size,
        padding_q,
        padding_kv,
        stride_q,
        stride_kv,
        qkv_projection_method,
        qkv_bias,
        attention_drop_rate,
        with_cls_token=...,
        **kwargs,
    ) -> None: ...
    def rearrange_for_multi_head_attention(self, hidden_state): ...
    def forward(self, hidden_state, height, width): ...

class CvtSelfOutput(nn.Module):
    def __init__(self, embed_dim, drop_rate) -> None: ...
    def forward(self, hidden_state, input_tensor): ...

class CvtAttention(nn.Module):
    def __init__(
        self,
        num_heads,
        embed_dim,
        kernel_size,
        padding_q,
        padding_kv,
        stride_q,
        stride_kv,
        qkv_projection_method,
        qkv_bias,
        attention_drop_rate,
        drop_rate,
        with_cls_token=...,
    ) -> None: ...
    def prune_heads(self, heads): ...
    def forward(self, hidden_state, height, width): ...

class CvtIntermediate(nn.Module):
    def __init__(self, embed_dim, mlp_ratio) -> None: ...
    def forward(self, hidden_state): ...

class CvtOutput(nn.Module):
    def __init__(self, embed_dim, mlp_ratio, drop_rate) -> None: ...
    def forward(self, hidden_state, input_tensor): ...

class CvtLayer(nn.Module):
    def __init__(
        self,
        num_heads,
        embed_dim,
        kernel_size,
        padding_q,
        padding_kv,
        stride_q,
        stride_kv,
        qkv_projection_method,
        qkv_bias,
        attention_drop_rate,
        drop_rate,
        mlp_ratio,
        drop_path_rate,
        with_cls_token=...,
    ) -> None: ...
    def forward(self, hidden_state, height, width): ...

class CvtStage(nn.Module):
    def __init__(self, config, stage) -> None: ...
    def forward(self, hidden_state): ...

class CvtEncoder(nn.Module):
    def __init__(self, config) -> None: ...
    def forward(self, pixel_values, output_hidden_states=..., return_dict=...): ...

@auto_docstring
class CvtPreTrainedModel(PreTrainedModel):
    config: CvtConfig
    base_model_prefix = ...
    main_input_name = ...
    _no_split_modules = ...

@auto_docstring
class CvtModel(CvtPreTrainedModel):
    def __init__(self, config, add_pooling_layer=...) -> None: ...
    @auto_docstring
    def forward(
        self,
        pixel_values: Optional[torch.Tensor] = ...,
        output_hidden_states: Optional[bool] = ...,
        return_dict: Optional[bool] = ...,
    ) -> Union[tuple, BaseModelOutputWithCLSToken]: ...

@auto_docstring(custom_intro=...)
class CvtForImageClassification(CvtPreTrainedModel):
    def __init__(self, config) -> None: ...
    @auto_docstring
    def forward(
        self,
        pixel_values: Optional[torch.Tensor] = ...,
        labels: Optional[torch.Tensor] = ...,
        output_hidden_states: Optional[bool] = ...,
        return_dict: Optional[bool] = ...,
    ) -> Union[tuple, ImageClassifierOutputWithNoAttention]: ...

__all__ = ["CvtForImageClassification", "CvtModel", "CvtPreTrainedModel"]
