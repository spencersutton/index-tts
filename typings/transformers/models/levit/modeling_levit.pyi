"""
This type stub file was generated by pyright.
"""

import torch
from dataclasses import dataclass
from typing import Optional, Union
from torch import nn
from ...modeling_outputs import (
    BaseModelOutputWithPoolingAndNoAttention,
    ImageClassifierOutputWithNoAttention,
    ModelOutput,
)
from ...modeling_utils import PreTrainedModel
from ...utils import auto_docstring
from .configuration_levit import LevitConfig

logger = ...

@dataclass
@auto_docstring(custom_intro=...)
class LevitForImageClassificationWithTeacherOutput(ModelOutput):
    logits: Optional[torch.FloatTensor] = ...
    cls_logits: Optional[torch.FloatTensor] = ...
    distillation_logits: Optional[torch.FloatTensor] = ...
    hidden_states: Optional[tuple[torch.FloatTensor]] = ...

class LevitConvEmbeddings(nn.Module):
    def __init__(
        self, in_channels, out_channels, kernel_size, stride, padding, dilation=..., groups=..., bn_weight_init=...
    ) -> None: ...
    def forward(self, embeddings): ...

class LevitPatchEmbeddings(nn.Module):
    def __init__(self, config) -> None: ...
    def forward(self, pixel_values): ...

class MLPLayerWithBN(nn.Module):
    def __init__(self, input_dim, output_dim, bn_weight_init=...) -> None: ...
    def forward(self, hidden_state): ...

class LevitSubsample(nn.Module):
    def __init__(self, stride, resolution) -> None: ...
    def forward(self, hidden_state): ...

class LevitAttention(nn.Module):
    def __init__(self, hidden_sizes, key_dim, num_attention_heads, attention_ratio, resolution) -> None: ...
    @torch.no_grad()
    def train(self, mode=...): ...
    def get_attention_biases(self, device): ...
    def forward(self, hidden_state): ...

class LevitAttentionSubsample(nn.Module):
    def __init__(
        self,
        input_dim,
        output_dim,
        key_dim,
        num_attention_heads,
        attention_ratio,
        stride,
        resolution_in,
        resolution_out,
    ) -> None: ...
    @torch.no_grad()
    def train(self, mode=...): ...
    def get_attention_biases(self, device): ...
    def forward(self, hidden_state): ...

class LevitMLPLayer(nn.Module):
    def __init__(self, input_dim, hidden_dim) -> None: ...
    def forward(self, hidden_state): ...

class LevitResidualLayer(nn.Module):
    def __init__(self, module, drop_rate) -> None: ...
    def forward(self, hidden_state): ...

class LevitStage(nn.Module):
    def __init__(
        self,
        config,
        idx,
        hidden_sizes,
        key_dim,
        depths,
        num_attention_heads,
        attention_ratio,
        mlp_ratio,
        down_ops,
        resolution_in,
    ) -> None: ...
    def get_resolution(self): ...
    def forward(self, hidden_state): ...

class LevitEncoder(nn.Module):
    def __init__(self, config) -> None: ...
    def forward(self, hidden_state, output_hidden_states=..., return_dict=...): ...

class LevitClassificationLayer(nn.Module):
    def __init__(self, input_dim, output_dim) -> None: ...
    def forward(self, hidden_state): ...

@auto_docstring
class LevitPreTrainedModel(PreTrainedModel):
    config: LevitConfig
    base_model_prefix = ...
    main_input_name = ...
    _no_split_modules = ...

@auto_docstring
class LevitModel(LevitPreTrainedModel):
    def __init__(self, config) -> None: ...
    @auto_docstring
    def forward(
        self,
        pixel_values: Optional[torch.FloatTensor] = ...,
        output_hidden_states: Optional[bool] = ...,
        return_dict: Optional[bool] = ...,
    ) -> Union[tuple, BaseModelOutputWithPoolingAndNoAttention]: ...

@auto_docstring(custom_intro=...)
class LevitForImageClassification(LevitPreTrainedModel):
    def __init__(self, config) -> None: ...
    @auto_docstring
    def forward(
        self,
        pixel_values: Optional[torch.FloatTensor] = ...,
        labels: Optional[torch.LongTensor] = ...,
        output_hidden_states: Optional[bool] = ...,
        return_dict: Optional[bool] = ...,
    ) -> Union[tuple, ImageClassifierOutputWithNoAttention]: ...

@auto_docstring(custom_intro=...)
class LevitForImageClassificationWithTeacher(LevitPreTrainedModel):
    def __init__(self, config) -> None: ...
    @auto_docstring
    def forward(
        self,
        pixel_values: Optional[torch.FloatTensor] = ...,
        output_hidden_states: Optional[bool] = ...,
        return_dict: Optional[bool] = ...,
    ) -> Union[tuple, LevitForImageClassificationWithTeacherOutput]: ...

__all__ = [
    "LevitForImageClassification",
    "LevitForImageClassificationWithTeacher",
    "LevitModel",
    "LevitPreTrainedModel",
]
