"""
This type stub file was generated by pyright.
"""

import torch
from typing import Optional
from ...image_processing_utils import BatchFeature
from ...image_processing_utils_fast import BaseImageProcessorFast, DefaultFastImageProcessorKwargs
from ...image_utils import ImageInput, SizeDict
from ...processing_utils import Unpack
from ...utils import auto_docstring, is_torch_available, is_torchvision_available, is_torchvision_v2_available
from torchvision.transforms.v2 import functional as F
from torchvision.transforms import functional as F

if is_torch_available(): ...
if is_torchvision_available() and is_torchvision_v2_available(): ...
else: ...

class SamFastImageProcessorKwargs(DefaultFastImageProcessorKwargs):
    mask_size: Optional[dict[str, int]]
    do_pad: Optional[bool]
    pad_size: Optional[dict[str, int]]
    mask_pad_size: Optional[dict[str, int]]
    ...

@auto_docstring
class SamImageProcessorFast(BaseImageProcessorFast):
    resample = ...
    image_mean = ...
    image_std = ...
    size = ...
    mask_size = ...
    do_resize = ...
    do_rescale = ...
    do_normalize = ...
    do_convert_rgb = ...
    valid_kwargs = SamFastImageProcessorKwargs
    do_pad = ...
    pad_size = ...
    mask_pad_size = ...
    def __init__(self, **kwargs: Unpack[SamFastImageProcessorKwargs]) -> None: ...
    def pad_image(self, images: torch.Tensor, pad_size: SizeDict): ...
    def resize(
        self, image: torch.Tensor, size: SizeDict, interpolation: Optional[F.InterpolationMode], **kwargs
    ) -> torch.Tensor: ...
    @auto_docstring
    def preprocess(
        self,
        images: ImageInput,
        segmentation_maps: Optional[ImageInput] = ...,
        **kwargs: Unpack[SamFastImageProcessorKwargs],
    ) -> BatchFeature: ...
    def generate_crop_boxes(
        self,
        image: torch.Tensor,
        target_size,
        crop_n_layers: int = ...,
        overlap_ratio: float = ...,
        points_per_crop: Optional[int] = ...,
        crop_n_points_downscale_factor: Optional[list[int]] = ...,
        device: Optional[torch.device] = ...,
    ): ...
    def filter_masks(
        self,
        masks,
        iou_scores,
        original_size,
        cropped_box_image,
        pred_iou_thresh=...,
        stability_score_thresh=...,
        mask_threshold=...,
        stability_score_offset=...,
    ): ...
    def post_process_masks(
        self, masks, original_sizes, reshaped_input_sizes, mask_threshold=..., binarize=..., pad_size=...
    ): ...
    def post_process_for_mask_generation(self, all_masks, all_scores, all_boxes, crops_nms_thresh): ...

__all__ = ["SamImageProcessorFast"]
