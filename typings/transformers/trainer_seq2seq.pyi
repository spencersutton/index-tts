"""
This type stub file was generated by pyright.
"""

import torch
import datasets
from typing import Any, Callable, Optional, TYPE_CHECKING, Union
from torch import nn
from torch.utils.data import Dataset, IterableDataset
from .generation.configuration_utils import GenerationConfig
from .trainer import Trainer
from .utils import is_datasets_available
from .utils.deprecation import deprecate_kwarg
from .data.data_collator import DataCollator
from .feature_extraction_utils import FeatureExtractionMixin
from .image_processing_utils import BaseImageProcessor
from .modeling_utils import PreTrainedModel
from .processing_utils import ProcessorMixin
from .tokenization_utils_base import PreTrainedTokenizerBase
from .trainer_callback import TrainerCallback
from .trainer_utils import EvalPrediction, PredictionOutput
from .training_args import TrainingArguments

if is_datasets_available(): ...
if TYPE_CHECKING: ...
logger = ...

class Seq2SeqTrainer(Trainer):
    @deprecate_kwarg("tokenizer", new_name="processing_class", version="5.0.0", raise_if_both_names=True)
    def __init__(
        self,
        model: Union[PreTrainedModel, nn.Module] = ...,
        args: TrainingArguments = ...,
        data_collator: Optional[DataCollator] = ...,
        train_dataset: Optional[Union[Dataset, IterableDataset, datasets.Dataset]] = ...,
        eval_dataset: Optional[Union[Dataset, dict[str, Dataset]]] = ...,
        processing_class: Optional[
            Union[PreTrainedTokenizerBase, BaseImageProcessor, FeatureExtractionMixin, ProcessorMixin]
        ] = ...,
        model_init: Optional[Callable[[], PreTrainedModel]] = ...,
        compute_loss_func: Optional[Callable] = ...,
        compute_metrics: Optional[Callable[[EvalPrediction], dict]] = ...,
        callbacks: Optional[list[TrainerCallback]] = ...,
        optimizers: tuple[torch.optim.Optimizer, torch.optim.lr_scheduler.LambdaLR] = ...,
        preprocess_logits_for_metrics: Optional[Callable[[torch.Tensor, torch.Tensor], torch.Tensor]] = ...,
    ) -> None: ...
    @staticmethod
    def load_generation_config(gen_config_arg: Union[str, GenerationConfig]) -> GenerationConfig: ...
    def evaluate(
        self,
        eval_dataset: Optional[Dataset] = ...,
        ignore_keys: Optional[list[str]] = ...,
        metric_key_prefix: str = ...,
        **gen_kwargs,
    ) -> dict[str, float]: ...
    def predict(
        self, test_dataset: Dataset, ignore_keys: Optional[list[str]] = ..., metric_key_prefix: str = ..., **gen_kwargs
    ) -> PredictionOutput: ...
    def prediction_step(
        self,
        model: nn.Module,
        inputs: dict[str, Union[torch.Tensor, Any]],
        prediction_loss_only: bool,
        ignore_keys: Optional[list[str]] = ...,
        **gen_kwargs,
    ) -> tuple[Optional[float], Optional[torch.Tensor], Optional[torch.Tensor]]: ...
