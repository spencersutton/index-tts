"""
This type stub file was generated by pyright.
"""

from torch.nn import Module
from x_transformers.x_transformers import TransformerWrapper

"""
This type stub file was generated by pyright.
"""

def exists(v): ...
def freeze_all_layers_(module): ...
def log_prob_from_model_and_seq(model, seq): ...
def masked_mean(log_probs, mask=...): ...
def maybe_and_mask(*masks): ...

class DPO(Module):
    def __init__(self, model: TransformerWrapper, *, beta=..., pad_id=...) -> None: ...
    def parameters(self): ...
    def forward(
        self, preferred_seq, unpreferred_seq, *, prompt_mask, preferred_seq_mask=..., unpreferred_seq_mask=...
    ): ...
