"""
This type stub file was generated by pyright.
"""

import torch
from torch.nn import Module
from x_transformers.x_transformers import TransformerWrapper

"""
This type stub file was generated by pyright.
"""

def exists(v): ...
def default(v, d): ...
def divisible_by(num, den): ...
def random_sequences(num_tokens, seq_len, num_samples_random, num_samples_constant, shuffle=..., device=...): ...

class SyntheticDataGenerator(Module):
    def __init__(self, dim, num_tokens, max_seq_len=..., hidden_size=..., use_gru=..., network_klass=...) -> None: ...
    def reset_(self): ...
    @torch.no_grad()
    def init_(self, m): ...
    @torch.inference_mode()
    @torch.compile
    def generate(self, length, seed=..., condition=..., temperature=...): ...
    def forward(self, input, hiddens=...): ...

class UniversalPretrainWrapper(Module):
    def __init__(
        self,
        model: TransformerWrapper,
        data_generator: SyntheticDataGenerator | Module | None = ...,
        buffer_size=...,
        num_reset=...,
        batch_size=...,
        seq_len=...,
        seed_length=...,
        reset_turing_machine_every=...,
        keep_buffer_on_cpu=...,
    ) -> None: ...
    @property
    def device(self): ...
    def get_rand_sequences_from_buffer(self, size=...): ...
    def forward(self): ...
